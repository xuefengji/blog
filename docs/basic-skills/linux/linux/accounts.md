# 账号管理

+ Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统
+ 用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护
+ 每个用户账号都拥有一个唯一的用户名和各自的口令
+ 用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录
+ 实现用户账号的管理，要完成的工作主要有如下几个方面：
    + 用户账号的添加、删除与修改
    + 用户口令的管理
    + 用户组的管理

## 用户账号的管理

+ 用户账号的管理工作主要涉及到用户账号的添加、修改和删除
+ 添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录 Shell 等资源

### useradd  添加账号

**语法**：
```shell script
useradd 选项 用户名
```

**选项** :

+ -c ：comment 指定一段注释性描述
+ -d ：目录 指定用户主目录，如果此目录不存在，则同时使用 -m 选项，可以创建主目录
+ -g ：用户组 指定用户所属的用户组
+ -G ：用户组，用户组 指定用户所属的附加组
+ -m：使用者目录如不存在则自动建立
+ -s ：Shell 文件 指定用户的登录 Shell
+ -u ：用户号 指定用户的用户号，如果同时有 -o 选项，则可以重复使用其他用户的标识号

**示例**：
```shell script
# 此命令创建了一个用户 snowji，其中-m选项用来为登录名 snowji 产生一个主目录 /home/kuangshen
[root@VM-16-7-centos home]# useradd -m snowji
```
增加用户账号就是在 `/etc/passwd` 文件中为新用户增加一条记录，同时更新其他系统文件如 `/etc/shadow`, `/etc/group` 等

### Linux 下切换用户

+ 切换用户的命令为：`su username `
+ 从普通用户切换到 root 用户，还可以使用命令：`sudo su`
+ 在终端输入 exit 或 logout 或使用快捷方式 `ctrl+d`，可以退回到原来用户，其实 `ctrl+d` 也是执行的 exit 命令
+ 在切换用户时，如果想在切换用户之后使用新用户的工作环境，可以在 su 和 username 之间加`-`，如：【su - root】
+ `$`表示普通用户
+ `#`表示超级用户，也就是 root 用户

### 删除帐号

删除用户账号就是要将 `/etc/passwd` 等系统文件中的该用户记录删除，必要时还删除用户的主目录

删除一个已有的用户账号使用 userdel 命令，其格式如下：
```bash
userdel 选项 用户名
```
常用的选项是 -r，它的作用是把用户的主目录一起删除
```bash
[root@VM-16-7-centos home]# userdel -r snowji
```
此命令删除用户 snowji在系统文件中（主要是 `/etc/passwd`、`/etc/shadow`、`/etc/group` 等）的记录，同时删除用户的主目录

### 修改帐号

修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录 Shell 等。

修改已有用户的信息使用 usermod 命令，其格式如下：
```bash
usermod 选项 用户名
```
**常用的选项**:
+ -c：comment 指定一段注释性描述
+ -d：目录 指定用户主目录，如果此目录不存在，则同时使用 -m 选项，可以创建主目录
+ -m：使用者目录如不存在则自动建立
+ -g：指定用户所属的用户组
+ -G：用户组，用户组 指定用户所属的附加组
+ -s：Shell 文件 指定用户的登录 Shell
+ -u：指定用户的用户号，如果同时有 -o 选项，则可以重复使用其他用户的标识号

例如：
```bash
#usermod -s /bin/ksh -d /home/z –g developer snowji
```
此命令将用户 snowji 的登录 Shell 修改为 ksh，主目录改为 `/home/z`，用户组改为 developer

### 设置用户密码

+ 用户管理的一项重要内容是用户口令的管理，用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令
+ 指定和修改用户口令的 Shell 命令是 passwd，超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令

**语法**：
```bash
passwd 选项 用户名
```
**可使用的选项**：

+ -l ：锁定口令，即禁用账号
+ -u： 口令解锁
+ -d ：使账号无口令
+ -f ：强迫用户下次登录时修改口令

如果默认用户名，则修改当前用户的口令

例如：

假设当前用户是 snowji，则下面的命令修改该用户自己的口令：
```bash
$ passwd
Old password:******
New password:*******
Re-enter new password:*******
```
如果是超级用户，可以用下列形式指定任何用户的口令：
```bash
#passwd snowji
New password:*******
Re-enter new password:*******
```
+ 普通用户修改自己的口令时，passwd 命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户
+ 而超级用户为用户指定口令时，就不需要知道原口令
+ 为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用 8 位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同

为用户指定空口令时，执行下列形式的命令：
```bash
#passwd -d snowji
```
此命令将用户 snowji 的口令删除，这样用户 snowji 下一次登录时，系统就不再允许该用户登录了

passwd 命令还可以用 `-l(lock)` 选项锁定某一用户，使其不能登录，例如：
```bash
#passwd -l snowji
```

