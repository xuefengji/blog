# 子网掩码

前情提要：了解 IP 地址的结构，可参考 [IP地址](/basic-skills/network/IP地址/)

## 简介

目的：

+ 方便管理，不同的子网可以相互隔离
+ 缓解 IP 地址资源紧张

原理：

+ 一般 IP 分为 2 个部分：网络号 + 主机号

+ 网络号：一般是将网络部分和子网部分合并

表示： 32 位的二进制，1 表示网络号，0 表示主机号

## 网络号和主机号计算

规则：将 IP 地址与子网掩码均转换为二进制后，按位进行**与运算**

**栗子**：

IP : 一个 C 类的地址，192.168.0.3

子网掩码: 255.255.255.0

**计算步骤**：

+ 转成二进制

  ```
  ip:   192.168.0.3   >  11000000 10101000 00000000 00000011
  网掩码：255.255.255.0 >  11111111 11111111 11111111 00000000
  ```

+  两个二进制按位做与计算 

  ```
  11000000 10101000 00000000 00000011
  &
  11111111 11111111 11111111 00000000
  =
  11000000 10101000 00000000 00000000
  ```

+ 将上面的结果每个 8 位转为十进制为 

  ```
  11000000 10101000 00000000 00000000 > 192.168.0.0
  结论：192.168.0.0 为网络号(网络段)
       3 为主机号(主机在子网中的标识)
  ```
## CIDR/VLSM
**CIDR**：无类别域间路由

```\
192.168.0.3/24
24: 表示 IP 前 24 位是网络号，剩下的 8 位是主机号
主机号：全 0 表示网络标识，全 1 表示广播地址，其他的是该子网的可用地址
```

栗子：

```
192.168.0.3   =>  11000000 10101000 00000000 00000011

网络标识的前缀： 11000000 10101000 00000000 --（前24位）换算位10进制：192.168.0
网络标识: 11000000 10101000 00000000 00000000 --剩下8位全是0，转10进制是：192.168.0.0
广播地址  11000000 10101000 00000000 11111111 --剩下8位全是1，转10进制是：192.168.0.255
```

**VLSM**：可变长子网掩码

**栗子**：

IP 地址：192.168.0.3/24

+ 这个地址前 24 位全 1 ，也就是 255.255.255.0 是这个网络的子网掩码
+ 无类别域间路由是基于可变长子网掩码来进行任意长度的前缀分配的，所以 24 可以变成其他数，如 16、20 等

```
192.168.0.3/16
只有前16位是网络，后面是地址16标识,换算如下：
192.168.0.0 是网络标识（后16位二进制全位0）
192.168.255.255这个是域内广播地址（后16位二进制全为1）
```

## 反掩码

### 什么是反掩码

+ 32 位点分十进制数
+ 反掩码就是通配符掩码
+ 通过标记 0 和 1 告诉设备匹配到哪位
+ 检查相应位为 0 的，忽略相应位为 1 的

栗子：
```shell
CIDR  子网掩码           反掩码
/30   255.255.255.252   0.0.0.3
/24   255.255.255.0     0.0.0.255
/16   255.255.0.0       0.0.255.255
```

### 反掩码的使用

通常在设置路由时，会使用到反掩码与源或目的地址一起匹配 IP 地址所属网络

（完）







